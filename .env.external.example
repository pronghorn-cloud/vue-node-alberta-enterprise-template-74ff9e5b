# =============================================================================
# Environment Configuration - EXTERNAL (SAML 2.0)
# =============================================================================
# This configuration is for EXTERNAL-facing government applications using
# SAML 2.0 authentication for citizens, businesses, and external users.
#
# Copy this file to .env and fill in the values from your SAML Identity Provider.
#
# PLACEHOLDER PATTERN: Values wrapped in {{VARIABLE_NAME}} are placeholders.
# Replace them with your actual values (remove the {{ }} brackets).
# Example: {{YOUR_SAML_IDP_SSO_URL}} â†’ https://idp.example.com/saml/sso
#
# See docs/AUTH-SETUP.md for detailed setup instructions.
# =============================================================================

# -----------------------------------------------------------------------------
# Application
# -----------------------------------------------------------------------------
NODE_ENV=production
PORT=3000
APP_NAME=Alberta Government Public Application

# -----------------------------------------------------------------------------
# Database (PostgreSQL)
# -----------------------------------------------------------------------------
# Connection string format: postgresql://username:password@host:port/database
# For production, use Azure Database for PostgreSQL or similar managed service
DB_CONNECTION_STRING={{DATABASE_CONNECTION_STRING}}

# -----------------------------------------------------------------------------
# Session Management
# -----------------------------------------------------------------------------
# Generate a secure random string (32+ characters) for production
# Example: openssl rand -base64 32
SESSION_SECRET={{GENERATE_WITH_OPENSSL_RAND_BASE64_32}}
SESSION_STORE=postgres

# -----------------------------------------------------------------------------
# Authentication - SAML 2.0
# -----------------------------------------------------------------------------
AUTH_DRIVER=saml

# Callback URL - where SAML IdP redirects after authentication (Assertion Consumer Service URL)
# Must match the ACS URL configured in your SAML Identity Provider
# Format: https://your-domain.alberta.ca/api/v1/auth/callback
AUTH_CALLBACK_URL=https://public.app.alberta.ca/api/v1/auth/callback

# SAML IdP Entry Point (SSO URL)
# The URL where users are redirected to authenticate with the Identity Provider
# Example: https://idp.example.com/saml/sso
SAML_ENTRY_POINT={{YOUR_SAML_IDP_SSO_URL}}

# SAML Issuer (Entity ID)
# Unique identifier for your application (Service Provider)
# Format: urn:alberta:{app-name}:{environment}
SAML_ISSUER=urn:alberta:app:external

# SAML IdP Certificate (X.509)
# Public certificate from your Identity Provider (PEM format, base64 encoded)
# Can be a single line (with \n) or multiline string
# To convert multiline PEM to single line: awk 'NF {sub(/\r/, ""); printf "%s\\n",$0;}' cert.pem
SAML_CERT={{YOUR_IDP_CERTIFICATE_BASE64}}

# Optional: SAML Service Provider Private Key
# Private key for signing SAML requests (PEM format, base64 encoded)
# Required if your IdP expects signed requests
# SAML_PRIVATE_KEY={{YOUR_SP_PRIVATE_KEY_BASE64}}

# Optional: SAML Service Provider Certificate
# Public certificate for your application (PEM format, base64 encoded)
# Required if using a private key for request signing
# SAML_CERT_SP={{YOUR_SP_CERTIFICATE_BASE64}}

# Optional: SAML Protocol
# Default: "saml2" (SAML 2.0)
# SAML_PROTOCOL=saml2

# Optional: Sign SAML requests
# Default: false (set to true if IdP requires signed requests)
# SAML_SIGN_REQUESTS=false

# Optional: Validate SAML response signatures
# Default: true (recommended for security)
# SAML_WANT_ASSERTIONS_SIGNED=true

# Optional: Force authentication
# Default: false (set to true to require re-authentication every time)
# SAML_FORCE_AUTHN=false

# Optional: Name ID format
# Default: "urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"
# SAML_NAME_ID_FORMAT=urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress

# -----------------------------------------------------------------------------
# SAML Attribute Mapping
# -----------------------------------------------------------------------------
# Map SAML assertion attributes to user fields
# Default values are shown below (uncomment to customize)

# User ID attribute
# SAML_ATTRIBUTE_ID=http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier

# Email attribute
# SAML_ATTRIBUTE_EMAIL=http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress

# Display name attribute
# SAML_ATTRIBUTE_NAME=http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name

# First name attribute
# SAML_ATTRIBUTE_FIRST_NAME=http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname

# Last name attribute
# SAML_ATTRIBUTE_LAST_NAME=http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname

# Roles attribute (can be multi-valued)
# SAML_ATTRIBUTE_ROLES=http://schemas.microsoft.com/ws/2008/06/identity/claims/role

# Optional: Default role for users with no assigned roles
# SAML_DEFAULT_ROLE=citizen

# -----------------------------------------------------------------------------
# SAML Logout
# -----------------------------------------------------------------------------
# Optional: SAML Single Logout URL
# URL for initiating Single Logout with the Identity Provider
# SAML_LOGOUT_URL={{YOUR_SAML_IDP_LOGOUT_URL}}

# Optional: Logout callback URL
# Where IdP redirects after logout (must be configured in IdP)
# SAML_LOGOUT_CALLBACK_URL=https://public.app.alberta.ca/api/v1/auth/logout/callback

# -----------------------------------------------------------------------------
# Frontend
# -----------------------------------------------------------------------------
# URL where the Vue.js app is hosted
WEB_URL=https://public.app.alberta.ca

# CORS origin (must match WEB_URL for credentials)
CORS_ORIGIN=https://public.app.alberta.ca

# -----------------------------------------------------------------------------
# Security
# -----------------------------------------------------------------------------
# Rate limiting - max requests per 15 minutes per IP
# Lower limit for public-facing applications
RATE_LIMIT_MAX=100

# Rate limiting for auth endpoints - stricter limits
AUTH_RATE_LIMIT_MAX=5

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
# Log level: error, warn, info, debug
LOG_LEVEL=info

# Log format: combined, common, dev, short, tiny
LOG_FORMAT=combined
